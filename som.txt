
func (c *Controller) generateUserCert(user User) error {
	certPath := filepath.Join(c.certDir, fmt.Sprintf("%s.crt", user.Username))
	keyPath := filepath.Join(c.certDir, fmt.Sprintf("%s.key", user.Username))

	// Create user certificate and save the certificate on local drive
	err := signUserCertificate(user.Username, user.Email)
	if err != nil {
		return err
	}

	// Verify certificate
	_, err = c.pathExist(certPath, keyPath)
	if err != nil {
		return err
	}

	_, err = isCertificateValid(certPath)
	if err != nil {
		return err
	}

	return nil
}